# CBRdb: A Curated Biochemical Reaction database for precise Biochemical Reaction Analysis

We present CBR-db, a curated biochemical database that integrates and refines data from KEGG and ATLAS databases to support precise analyses of biochemical reaction data. This curation effort addresses key limitations, such as the presence of malformed chemical representations, inaccurate stoichiometry, and ambiguous or incomplete reaction entries. These key improvements in CBR-db could facilitate accurate analysis of physicochemical and thermodynamic properties, which are essential for modeling the evolution of chemical reactions in research areas ranging from prebiotic chemistry to metabolic network expansion. Altogether, CBR-db features a high number of high-quality reactions and compounds. CBR-db is designed to be continuously updated, incorporating the latest releases from KEGG and ATLAS databases. Furthermore, it provides a framework so that the network can be extended and further issues can be improved.


To start everything locally, you can look at run_all.py, which will take you over the whole data pipeline. Otherwise, you can run each part by themselves.


## Installation
### Fresh environment
It is recommended that you start from a fresh environment to prevent issues.
```
conda create -n cbrdb_env python=3.12
```
Activate the new env.
```
conda activate cbrdb_env
```
Add channels in this order.
```
conda config --env --add channels conda-forge
```
Best to make them strict
```
conda config --set channel_priority true
```
To check your updated channel list, run:
```
conda config --show channels
```
Make sure to upgrade the conda env to force the channel priority.
```
conda update conda --all -y
```
### Install the requirements
```
conda install conda-forge::numpy conda-forge::sympy conda-forge::matplotlib conda-forge::networkx conda-forge::pandas conda-forge::rdkit conda-forge::chempy conda-forge::requests conda-forge::urllib3 conda-forge::chemparse conda-forge::swifter -y
```
Then install CBRdb:
```
pip install git+https://github.com/ELIFE-ASU/CBRdb.git@v1.0.0
```

## References
If you use this code in your work, you must reference the following:

- Hafner, J., MohammadiPeyhani, H., Sveshnikova, A., Scheidegger, A., & Hatzimanikatis, V. (2020). Updated ATLAS of biochemistry with new metabolites and improved enzyme prediction power. ACS synthetic biology, 9(6), 1479-1482.

- Hadadi, N., Hafner, J., Shajkofci, A., Zisaki, A., & Hatzimanikatis, V. (2016). ATLAS of biochemistry: a repository of all possible biochemical reactions for synthetic biology and metabolic engineering studies. ACS synthetic biology, 5(10), 1155-1166.

- Kanehisa, M., & Goto, S. (2000). KEGG: kyoto encyclopedia of genes and genomes. Nucleic acids research, 28(1), 27-30.

See .bib file.

## Examples of issues with KEGG and ATLAS
Here are a couple of example problems that this code attempts to solve.

### Compounds
- Cases where the R group notation is unstandardized, for example, R#, R, *, is used interchangeably.
- Case with no mol file: C00028, C00030, C00505, C00923, ... etc
- Case with broken mol files, for example, in some cases, OH is an element: C20442, C21011, C21012, C21013, C22197, ... etc.
- Halogen generalized mol file: C00462, C01322, C01365, C01706, ... etc

### Reactions
- Unbalanced; nothing is missing, but the elemental stoichiometry is incorrect
- One or more elements are missing from a side of the equation: , ... etc
- One or more compounds are missing from a side of the equation: , ... etc
- Zero population (for ATLAS KEGG FILE): R04242, R04254, ... etc
- Reactions that are part of shortcuts and are represented by chains of other reactions: , ... etc
- Unclear reactions: R10743, ... etc
- reactions with unclear compounds: , ... etc


## File Generation explained
Anything that begins with KEGG is from KEGG. Anything that starts with ATLAS comes from ATLAS.
- KEGG reactions (2024). A latest-to-date web scrape of KEGG.
- ATLAS reactions expansion. 149052 known and novel reactions generated by BNICE.ch with a suggestion for EC classification up to the 3rd level EC number.
- ATLAS's KEGG reactions pull (2018). Curated KEGG reactions by the ATLAS authors.

## Un-Processed files

These are considered raw and unprocessed. Please be sure to use caution.

| Final files | Description |
| :---        |    :----   |
| kegg_data_R.csv.zip | KEGG reactions (2024) list |
| atlas_data_R.csv.zip | ATLAS reactions expansion |
| atlas_data_kegg_R.csv.zip | ATLAS's KEGG reactions pull (2018) |

## Processed files

These are processed files that have been filtered and processed.

| Final files | Description |
| :---        |    :----   |
| kegg_data_C.csv.zip | This is your go-to for processed and vetted compounds. |
| ec_ids.csv.zip | This is a complete list of ECs for all the reactions. |
| kegg_data_R_processed.csv.zip | Processed KEGG reactions (2024) list |
| atlas_data_R_processed.csv.zip | Processed ATLAS reactions expansion |
| atlas_data_kegg_R_processed.csv.zip | ATLAS's KEGG reactions pull (2018) |

## Merged files

These are files that have been merged for convenience.

| Final files | Description |
| :---        |    :----   |
| atlas_kegg_processed_merged.csv.zip | kegg_data_R_processed (2024) + atlas_data_R_processed = kegg_atlas_processed_merged |
| kegg_atlas_processed_merged.csv.zip | atlas_data_kegg_R_processed (2018) + atlas_data_R_processed = atlas_kegg_processed_merged |



## Intermediate files

Along the way, you might generate a list of files corresponding to bad or good compound or reaction IDs.

| Intermediate files | Description |
| :---        |    :----   |
| C_IDs_bad.dat | Bad compound IDs to skip |
| C_IDs_good.dat | Good compound IDs to follow up on |
| C_IDs_manual.dat | Based off of C_IDs_good these correspond to manual fixes |
| R_IDs_bad.dat | A list of reactions that have been marked as bad and are not included in final data sets |

